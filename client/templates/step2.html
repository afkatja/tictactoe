<template name="step2">
  <h1>More boxes!</h1>
  <p>In this step, we will be creating more boxes for our gameboard.</p>
  <p>There is currently only one box on our gameboard. For tictactoe we need 9 of them. But we don't want to write 9 <code>div</code>s in our code, do we?</p>

  <h2>Create a collection</h2>
  <p>Because we are using Meteor, we will use something built in, which is called <code>Collection</code>. This will be the place to store all the boxes. Read more about Collections <a href="http://docs.meteor.com/#/full/mongo_collection">here</a></p>
  {{#prism language="javascript" class="line-numbers" data-line="1-2, 4, 5"}}
    Boxes = new Mongo.Collection('boxes');
  {{/prism}}
  <p>In order to make 9 boxes, you need to use a <code>loop</code>, like this:</p>
  {{#prism language="javascript" class="line-numbers" data-line="1-2, 4, 5"}}
  for(var i = 0; i &lt; 9; i++){
    //do something here
  }
  {{/prism}}
  Read more about it <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/for">here</a>.
  <h2>Populate the collection</h2>
  <p>In the server code you can fill the collection. Add an object with a <code>boxIndex</code> to it:</p>
  {{#prism language="javascript" class="line-numbers" data-line="1-2, 4, 5"}}
    //fill 9 cells
    if(Boxes.find({}).count() === 0) {
      for(var i = 0; i &lt; 9; i++){
        Boxes.insert({boxIndex: i});
      }
    }
  {{/prism}}
  <p>We add the collection on the server code so that it is created only once. Read about Client and Server parts of Meteor application <a href="https://www.discovermeteor.com/blog/what-goes-where/">here</a>.
  The most part we will do today will be on the client.</p>
  <blockquote cite="http://meteortips.com/first-meteor-tutorial/templates/">
    When the code is executed on the server, a collection is created inside the Mongo database. This is where our data is stored. When the code is executed from inside the user’s web browser though — on the client-side — a local copy of that collection is created on that user’s computer. As a result, when the user interacts with the database, they’re actually interacting with their local copy. This is partly why Meteor applications are real-time by default. Data is manipulated on the user’s local machine and then invisibly synced in the background with the server-side database.
  </blockquote>

  <h2>Display the collection</h2>
  <p>Try to log to console everytime you add a new item into the collection:</p>
  {{#prism language="javascript" class="line-numbers" data-line="1-2, 4, 5"}}
    console.log('inserted box with index', i);
  {{/prism}}
  <p>You can then open the browser's console by right clicking on the page and selecting <code>Inspect</code> - it looks like this: <img src="http://blog.teamtreehouse.com/wp-content/uploads/2014/01/dev-tools-console.png"></p>

  <p>So now you should have the following code running from your javascript file:</p>
  {{#prism language="javascript" class="line-numbers"}}
  //fill 9 cells
  if(Boxes.find().count() === 0) {
    for(var i = 0; i &lt; 9; i++){
      Boxes.insert({boxIndex: i});
      console.log('inserted box with index', i);
    }
  }
  {{/prism}}
  <p>In the following step, we will display the boxes we have just made, in our <code>html</code> file.</p>

  {{> summary}}
  <p>We now know about Collections within Meteor that allow us to store, retrieve and manipulate data that we can access from our templates.</p>
  <p>We used the the <code>find()</code> and <code>count()</code> functions on the Collection to return the number of boxes in the <code>Boxes</code> collection.</p>
  <p>We also know that a Meteor application can run on both the client and the server. We can use the <code>isClient</code> and <code>isServer</code> conditionals to control where the code is run.</p>
</template>
